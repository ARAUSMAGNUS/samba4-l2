Autor: Robson Vaamonde
Site: www.procedimentosemti.com.br
Facebook: facebook.com/ProcedimentosEmTI
Facebook: facebook.com/BoraParaPratica
YouTube: youtube.com/BoraParaPratica
Data de criação: 31/05/2016
Data de atualização: 27/09/2018
Versão: 0.13
Testado e homologado para a versão do Ubuntu Server 16.04 LTS x64
Kernel >= 4.4.x

27/09/2018  - Auditoria do script-23.sh: script com falha no final da execução, análise de LOG sem falhas. Robson Vaamonde
(Esse script de firewall pode gerar falhas de conexão entre clientes Windows ou GNU/Linux, executando análise de log do iptables para avaliação das regração)

27/09/2018  - Auditoria do script-22.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Executando testes nos script de criação das impressoras PDF, recomendado utilizar o Cups-PDF).

27/09/2018  - Auditoria do script-21.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde

27/09/2018  - Auditoria do script-20.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(No vídeo não consta o script para limpeza da pasta de lixeira, esse script foi acrescentado depois da gravação)

27/09/2018  - Falhas de acesso aos compartilhamentos do SAMBA-4, comentado as linhas: #Proteção contra códigos maliciosos: WannaCry for SAMBA-4 e #Liberando as a rede 192.168.1.0/24 ter acesso aos compartilhamentos do SAMBA-4, negando todas as outras do arquivo /etc/samba/smb.conf. Robson Vaamonde
(Após comentar essas linhas o acesso aos compartilhamento foi feito com sucesso, analisar falhas de configuração referente aos protocolos e libração de acesso)

27/09/2018  - Auditoria no script-19.sh: falha na execução do teste: smbclient -L localhost -N - erro: protocol negotiation failed: NT_STATUS_INVALID_NETWORK_RESPONSE. Robson Vaamonde
(Executando o comando: sudo service samba-ad-dc status - linha de erro de: Denied Connection from ::1 (loopback)

27/09/2018  - Auditoria do script-18.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-17.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-16.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-15.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-14.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-13.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-12.sh: script funcionando perfeitamente, análise de LOG sem fahas. Robson Vaamonde

27/09/2018  - Auditoria do script-11.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Nessa análise o foco foi verificar os serviços do samba-ad-dc, smbd, nmbd, bind9, apparmor)

27/09/2018  - Auditoria do script-10.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Nessa análise o foco foi verificar o percentual de ocupação do disco em relação a HD 8GB e nova configuração com 20GB)

27/09/2018  - Auditoria do script-09.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Auditoria feita na versão do Ubuntu 16.04.5, Kernel 4.4.0-135, SAMBA 4.3.11, Bind 9.10.3)

27/09/2018  - Auditoria do script-08.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todas as portas de serviços estão funcionando perfeitamente)

27/09/2018  - Auditoria do script-07.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do arquivo /var/log/syslog, análise de erros referente ao BIND9 (named) e SAMBA4 (samba, samba-ad-dc, ). Robson Vaamonde

27/09/2018  - Auditoria dos arquivos /var/log/samba/*, análise de erros nos serviços de smbd, nmbd, winbind. Robson Vaamonde

27/09/2018  - Auditoria do script-06.sh: script funcionando perfeitamente, obs: melhorar a documentação dos conf's, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-05.sh: script funcionando perfeitamente, obs: melhorar a documentação dos conf's, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-04.sh: script funcionando perfeitamente, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

27/09/2018  - Auditoria do script-03.sh: script funcionando perfeitamente, obs: atualização da versão do Webmin - webmin_1.890_all.deb, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

26/09/2018  - Auditoria do script-02.sh: script funcionando perfeitamente, obs: atualização do arquivo /etc/hostname - remoção das linhas de comentários, adicionado a remoção do serviço SNAPD no script-02.sh, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

26/09/2018  - Auditoria do script-01.sh: script funcionando perfeitamente, obs: atualização do arquivo /etc/fstab - acrescimento da opção barrier=1 na partição /backup, análise de LOG sem falhas. Robson Vaamonde
(Todos os softwares e arquivos conf's estão funcionando perfeitamente, sem necessidade de atualização)

26/09/2018  - Auditoria do script-00.sh: script funcionando perfeitamente, obs: atualização do Kernel para a versão 4.4.0.135, análise de LOG sem falhas. Robson Vaamonde

26/09/2018  - Atualização de segurança, na partição /tmp marcar as opções: noatime e nodiratime. Robson Vaamonde

26/09/2018  - Aumento do tamanho das partições do sistema operacional: 10GB "/" raiz, 1.0GB swap, 1.0GB /tmp e 8GB /var. Robson Vaamonde

26/09/2018  - Utilização da ISO do Ubuntu Server 16.04.5 LTS, aumento do tamanho do Hard Disk do Sistema Operacional de 8GB para 20GB. Robson Vaamonde

03/03/2018  - Vários relatos de falha de conexão do SSH, correção do arquivo sshd_config na opção: PasswordAuthentication, estava no e alterou para yes, PubkeyAuthentication, estava yes alterou para no. Robson Vaamonde

09/06/2017  - Melhoria nas configurações do smb.conf para proteção do Malware/Ransomware WannaCry. Robson Vaamonde

25/05/2017  - Atualização do smb.conf acrescimo da linha: nt pipe support = proteção do WannaCry for SAMBA4. Robson Vaamonde

24/05/2017  - Melhoria no script-23.sh, regras de firewall para leberação das portas RPC. Robson Vaammonde

08/05/2017  - Atualização do script-23.sh para finalização dos vídeos e correções de bugs do Iptables. Robson Vaamonde

17/03/2017  - Atualização dos arquivos conf´s sshd_config, hosts.allow e hosts.deny. Robson Vaamonde

13/03/2017  - Criação do script-23.sh para configuração das regras de Firewall, atualização da versão do Webmin agora com suporte ao Bootstrap e Monitoramento do servidor no script-04.sh . Robson Vaamonde

15/01/2017  - Melhoria do script-02.sh, configurações do CUPS e impressoras. Robson Vaamonde

03/01/2017  - Melhorias dos scripts finais, criação das configuração do Apache2 e PHP, correções de bug de aspas ("). Robson Vaamonde

02/01/2017  - Atualização dos scripts: script-00.sh e script-03.sh, correções de bug de aspas ("). Robson Vaamonde

30/12/2016  - Atualização de todos os scripts: script-00.sh até script-22.sh melhorias na apresentação das mensagens na tela. Robson Vaamonde

29/12/2016  - Atualização do script-18.sh, customização do wp-config.php e htaccess. Robson Vaamonde

28/12/2016  - Atualização das configurações do firewall.sh é atualização do script-08.sh. Robson Vaamonde

24/12/2016  - Customização do arquivo php.ini, mysqld.cnf, apache2.conf. Robson Vaamonde

22/12/2016  - Criação do arquivos awstats.pti.intra.conf. Robson Vaamonde

20/12/2016  - Atualização do arquivo snmp.conf do CUPS e 000-default.conf para o AWStats. Robson Vaamonde

18/12/2016  - Atualização do script-22.sh, instalação do AWStats, limpeza do CUPS e Pasta PDF, corrigindo bugs do W3Perl. Robson Vaamonde

17/12/2016  - Atualização dos scripts-02.sh e scripts-14.sh, criação dos conf: clean_pdf, cleanpdf, clean_cups e cleancups. Robson Vaamonde

14/12/2016  - Customização dos arquivos: cupsd.conf, cups-pdf.conf, usr.sbin.cups, smb.conf, sambapdf, printpdf, clean_recycle, script-14.sh. Robson Vaamonde

12/12/2016  - Correção dos conf's smb.conf e cupsd.conf, falhas de log e acesso a pastas. Robson Vaamonde

07/12/2016  - Desenvolvimento do script-22.sh Configuração da Auditoria do Apache2 AWStats e Configuração da Auditoria do CUPS W3Perl. Robson Vaamonde

06/12/2016  - Atualização do script-02.sh, acréscimo de atualização de drivers para o Cups. Robson Vaamonde

04/12/2016  - Alteração do script-19.sh, copia final do arquivo smb.conf, atualizando o arquivo smb.conf com correções de herança de arquivos e permissões de grupos, atualização do script-14.sh, mudança da estrutura de pastas, resolver problema da Lixeira. Robson Vaamonde

22/11/2016  - Acréscimo das opções de Debug nos serviços do DHCPD e SSHD no script-05.sh, acréscimo das opções de Debug nos serviços Apache2 e ProFTDP no script-18.sh. Robson Vaamonde

21/11/2016  - Atualização da versão dos script para 0.7. Robson Vaamonde

21/11/2016  - Atualização do script-04.sh acréscimo da linha que permite o usuário root do mysql acessar a base de dados remotamente. Robson Vaamonde

26/09/2016  - Atualização do script-00.sh acréscimo da opção apt-get autoremove, atualização do arquivo conf/smb.conf, script-01.sh até script-20.sh melhoria na documentação, início da criação do script-21.sh para finalização dos recursos de auditoria do SAMBA4, correção do agendamento do clean_reclyed, criação do arquivo LICENSE com a GPL v3. Robson Vaamonde

14/08/2016  - Atualização do script-02.sh, acrescimo das impressora cups-pdf e modificação do arquivo cupsd.conf, printers.conf e cups-pdf.conf. Robson Vaamonde

10/08/2016  - Atualização de todos os agendamento, colocação de linha no final e comentário. Robson Vaamonde

09/08/2016  - Correção do script-06.sh - comando samba-tool domain info, correção do script07.sh na linha 123, falta de aspas duplas, correção do script-17, falta do comando wc -l nas linhas 79 e 96, correção do script-18.sh caracter estranho na linha 98 e melhoria no script. Robson Vaamonde.

08/08/2016  - Atualização do script-14.sh, atualização dos arquivos group.local e members.group. Robson Vaamonde

04/08/2016  - Melhoria no laço de loop do script-16.sh, correção da falha de listar associação de grupos. Robson Vaamonde

04/08/2016  - Início da documentação de todos os comandos executados nos scripts, criação das linhas de comentário em cada comando para facilitar o aprendizado. Robson Vaamonde

04/08/2016  - Atualização dos scripts de criação de Grupos Global e Local, acrescimo do grupo DL ACL-PastaGestao-R. Robson Vaamonde

04/08/2016  -	Criação do Log do script do samba_backup. Robson Vaamonde

04/08/2016  -	Correção da localização do arquivo rsync_samba, caminho: DESTINO="/backup/pti.intra/rsync", criação do Log de sincronismo.  Robson Vaamonde

03/08/2016  -	Criação do agendamento da limpeza da pasta lixeira no script-20.sh. Robson Vaamonde

03/08/2016  -	Correção do script de associação de grupos. Robson Vaamonde

02/08/2016  -	Criação do diretório Lixeira no script-14.sh. Robson Vaamonde

02/08/2016  -	Correção de falha do NTP Server, comando hwclock, date e ntpdate para atulização correta da hora de máquina, sistema e sincronismo no script-01.sh. Robson Vaamonde

02/08/2016  -	Atualização do arquivo smb.conf, correções de falha de permissões e de acesso as pastas, trabalhando com os comandos chmod e chgrp integrado com o Winbind. Robson Vaamonde

01/08/2016  -	Criação do diretório /backup/pti.intra/bkp para o agendamento do Backupninja, mudança do script14.sh. Robson Vaamonde

31/07/2016  -	Correção do script-20.sh, falha na volta do diretório do netdata após a instalação, remoção do diretório netdata. Robson Vaamonde

30/07/2016  -	Atualização de todos os script para a versão 0.4. Robson Vaamonde

29/07/2016  -	Acrescimo da opção: export DEBIAN_FRONTEND="noninteractive" no script-20.sh, correção das opções do postfix para o software Backupninja, criação dos scripts clean_public e rsync_samba, criação dos agendamento no /etc/cron.d/. Robson Vaamonde

28/07/2016  -	Correção do script-18.sh, melhoria na criação da senha do usuário do wordpress. Robson Vaamonde

28/07/2016  -	Correção de erros de EOF nos scripts de agendamento do /etc/cron.d/, espaços em brancos entre os *, teste com os comandos: tail -f /var/log/syslog | grep cron, run-parts --list /etc/cron.d. Robson Vaamonde

27/07/2016  -	Criação do agendamento da limpeza do diretório /arquivos/pti.intra/publico no script-20.sh. Robson Vaamonde

27/07/2016  -	Correção do script-18.sh, falha no comando passwd, digitado errado: password. Robson Vaamonde

27/07/2016  -	Melhoria no script-14.sh, criação da arvore de diretórios. Robson Vaamonde

27/07/2016  -	Melhoria nos scripts de criação de grupos, usuários e unidades organizacionais. Robson Vaamonde

26/07/2016  -	Correção dos caminhos dos scripts do cron.d. Robson Vaamonde

26/07/2016  -	Correção dos scripts do /etc/cron.d/ espaços em linhas no clamav, freshclam, sambadnsupdate é clamav-unofficial-sigs, confirmação: cat /var/log/syslog | grep cron. Robson Vaamonde

24/07/2016  -	Testes das opções: apt-get -o Dpkg::Options::="--force-confold" upgrade -q -y --force-yes | apt-get -o Dpkg::Options::="--force-confold" dist-upgrade -q -y --force-yes nos script-00.sh até scripts-06.sh, objetivo de não solicitar confirmação de troca de arquivos. Robson Vaamonde

24/07/2016  -	Correção dos script para utilização do apt-get upgrade ou dist-upgrade, quando existe a possibilidade de interação com o utilizador, acrescimo da linha: export DEBIAN_FRONTEND=noninteractive no início do script. Robson Vaamonde

19/07/2016  -	Aumentado o tempo de inatividade do sshd_config linha 42: ClientAliveInterval 60 para ClientAliveInterval 180. Robson Vaamonde

19/07/2016  -	Desativado da opção rndc-confgen -a do script-06.sh na linha 170, comando entrando em loop, analise de erro sendo feita. Robson Vaamonde

19/07/2016  -	Correção dos arquivos hosts.allow e hosts.deny espaço em branco entre os comentários. Robson Vaamonde

19/07/2016  -	Retirada do cabeçalho do arquivos issue.net, criação de espaços entre linhas para melhorar o script e a linha de autenticação. Robson Vaamonde
